<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AzulaBlitz - Luxury Fragrances Home</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
    <link rel="icon" href="favicon.ico">
    <script src="https://js.stripe.com/v3/"></script>
    <style>
        :root {
            --metallic-black: #000000;
            --steel-white: #C0C0C0;
            --gold-accent: #A37E2C;
            --brand-font-size: 2.5rem;
        }
        body {
            background-color: var(--metallic-black);
            color: var(--steel-white);
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            position: relative;
            overflow-x: hidden;
            box-sizing: border-box;
        }
        * {
            box-sizing: border-box;
        }
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--gold-accent);
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #8c6b25;
        }
        html {
            scrollbar-width: thin;
            scrollbar-color: var(--gold-accent) transparent;
        }
        .snow-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            overflow: hidden;
        }
        .snowflake {
            position: absolute;
            top: -10px;
            width: 5px;
            height: 5px;
            background: var(--steel-white);
            border-radius: 50%;
            animation: fall linear infinite;
            opacity: 0.7;
        }
        @keyframes fall {
            0% { transform: translateY(0); }
            100% { transform: translateY(100vh); }
        }
        header {
            position: sticky;
            top: 0;
            width: 100%;
            background: var(--metallic-black);
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 1000;
            box-shadow: 0 0 15px 5px rgba(163, 126, 44, 0.7);
        }
        .header-container {
            display: flex;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
        }
        .cart-icon {
            position: relative;
            margin-left: 1rem;
            cursor: pointer;
            transition: transform 0.2s;
        }
        .cart-icon:hover {
            transform: scale(1.1);
        }
        #cart-count {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--gold-accent);
            color: var(--metallic-black);
            border-radius: 50%;
            padding: 0.2rem 0.5rem;
            font-size: 0.8rem;
        }
        .logo img {
            height: 50px;
        }
        nav {
            flex-grow: 1;
            text-align: right;
        }
        nav ul {
            display: flex;
            list-style: none;
            padding: 0;
            margin: 0;
            justify-content: flex-end;
        }
        nav a {
            color: var(--steel-white);
            text-decoration: none;
            padding: 0 1.5rem;
            font-size: 1.2rem;
            transition: color 0.3s;
        }
        nav a:hover {
            color: var(--gold-accent);
        }
        #hamburger {
            display: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: var(--steel-white);
        }
        .hero {
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            padding: 2rem;
        }
        .hero h1 {
            font-family: 'Playfair Display', serif;
            font-size: 4.5rem;
            text-transform: uppercase;
            letter-spacing: 0.05rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .hero p.tagline {
            font-size: 1.5rem;
            margin-top: 1rem;
            font-style: italic;
        }
        .search-bar {
            margin-top: 2rem;
            position: relative;
            width: 600px;
            max-width: 90%;
        }
        #search-input {
            width: 100%;
            padding: 1rem 2.5rem 1rem 1rem;
            font-size: 1.2rem;
            border: 2px solid var(--gold-accent);
            background: var(--metallic-black);
            color: var(--steel-white);
            border-radius: 12px;
            outline: none;
        }
        #clear-search {
            position: absolute;
            right: 10px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--gold-accent);
            font-size: 1rem;
            cursor: pointer;
            display: none;
        }
        #autocomplete {
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: var(--metallic-black);
            border: 2px solid var(--gold-accent);
            border-top: none;
            border-radius: 0 0 12px 12px;
            max-height: 200px;
            overflow-y: auto;
            display: none;
            z-index: 100;
        }
        .autocomplete-item {
            padding: 0.5rem 1rem;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .autocomplete-item:hover {
            background: var(--gold-accent);
            color: var(--metallic-black);
        }
        .autocomplete-item .product-type {
            font-size: 0.9rem;
            opacity: 0.7;
        }
        #no-results {
            display: none;
            margin-top: 1rem;
            font-size: 1.2rem;
            color: var(--steel-white);
        }
        .featured {
            padding: 4rem 0;
            text-align: center;
        }
        .featured h2 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            border-bottom: 2px solid var(--gold-accent);
            display: inline-block;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .brand-section {
            margin-bottom: 3rem;
        }
        .brand-section h3 {
            font-family: 'Playfair Display', serif;
            font-size: var(--brand-font-size);
            margin-bottom: 1rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }
        .brand-section hr {
            border: none;
            border-top: 1px solid var(--gold-accent);
            margin: 2rem 0;
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            padding: 0 2rem;
        }
        .grid-item {
            background: var(--metallic-black);
            padding: 1.5rem;
            border-radius: 8px;
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            position: relative;
        }
        .grid-item.hidden {
            display: none;
        }
        .grid-item:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px var(--gold-accent);
        }
        .grid img {
            width: 100%;
            height: 200px;
            object-fit: contain;
            border-radius: 8px;
            margin-bottom: 1rem;
            background: none;
            loading: lazy;
        }
        .grid-item h4 {
            font-size: 1.4rem;
            margin: 0.5rem 0;
        }
        .grid-item p.price {
            font-size: 1.2rem;
            font-weight: bold;
        }
        .add-to-cart-btn {
            background: var(--gold-accent);
            color: var(--metallic-black);
            padding: 0.5rem 1rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 0.5rem;
            width: 100%;
            font-size: 1rem;
            text-decoration: none;
            display: block;
            text-align: center;
            transition: background 0.3s;
        }
        .add-to-cart-btn:hover {
            background: #8c6b25;
        }
        #cart-view, #checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1001;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        #cart-view.visible, #checkout-modal.visible {
            opacity: 1;
            pointer-events: auto;
        }
        #checkout-modal {
            display: none;
        }
        #checkout-modal.visible {
            display: flex;
        }
        .cart-content, .modal-content {
            background: var(--metallic-black);
            padding: 2rem;
            border-radius: 8px;
            max-width: 900px;
            width: 90%;
            text-align: center;
            position: relative;
            border: 2px solid var(--gold-accent);
            max-height: 80vh;
            overflow-y: auto;
        }
        .modal-content {
            max-width: 600px;
        }
        #close-cart, #close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: var(--steel-white);
            font-size: 1.5rem;
            cursor: pointer;
        }
        .cart-item {
            display: grid;
            grid-template-columns: 100px 2fr 1fr 1fr;
            align-items: center;
            margin: 1rem 0;
            border-bottom: 1px solid var(--gold-accent);
            padding-bottom: 1rem;
        }
        .cart-item img {
            width: 80px;
            height: 80px;
            object-fit: contain;
            border-radius: 4px;
        }
        .cart-item span {
            text-align: left;
        }
        .cart-item input {
            width: 60px;
            padding: 0.3rem;
            background: var(--metallic-black);
            color: var(--steel-white);
            border: 1px solid var(--gold-accent);
            border-radius: 4px;
            text-align: center;
        }
        .cart-item button {
            background: var(--gold-accent);
            color: var(--metallic-black);
            border: none;
            padding: 0.3rem 0.6rem;
            border-radius: 4px;
            cursor: pointer;
        }
        .cart-summary {
            margin-top: 2rem;
            text-align: right;
        }
        .quantity-controls {
            display: flex;
            gap: 0.5rem;
            align-items: center;
            justify-content: center;
        }
        #cart-subtotal, #cart-tax, #cart-shipping, #cart-total {
            font-size: 1.2rem;
            font-weight: bold;
            margin-top: 0.5rem;
        }
        #checkout-btn, #confirm-order {
            background: var(--gold-accent);
            color: var(--metallic-black);
            padding: 0.8rem 2rem;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 1rem;
            font-size: 1rem;
            transition: background 0.3s;
        }
        #checkout-btn:hover, #confirm-order:hover {
            background: #8c6b25;
        }
        #shipping-form, #payment-form {
            margin: 1rem 0;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        #shipping-form input, #shipping-form select, #payment-form input, #payment-form select {
            padding: 0.8rem;
            font-size: 1rem;
            border: 2px solid var(--gold-accent);
            background: var(--metallic-black);
            color: var(--steel-white);
            border-radius: 8px;
            outline: none;
        }
        #shipping-form input:invalid, #shipping-form select:invalid {
            border-color: #ff5555;
        }
        #shipping-form .error, #payment-form .error {
            color: #ff5555;
            font-size: 0.9rem;
            margin-top: 0.2rem;
            display: none;
        }
        #shipping-form input:invalid + .error, #shipping-form select:invalid + .error {
            display: block;
        }
        #card-element {
            padding: 0.8rem;
            border: 2px solid var(--gold-accent);
            background: var(--metallic-black);
            color: var(--steel-white);
            border-radius: 8px;
        }
        #order-preview ul {
            list-style: none;
            padding: 0;
            text-align: left;
        }
        .about, .contact {
            padding: 4rem 2rem;
            text-align: center;
        }
        .about h2, .contact h2 {
            font-family: 'Playfair Display', serif;
            font-size: 3.5rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
            margin-bottom: 1rem;
        }
        .about p, .contact p {
            font-size: 1.2rem;
            max-width: 600px;
            margin: 0 auto;
        }
        .contact form {
            max-width: 600px;
            margin: 2rem auto;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }
        .contact input, .contact textarea {
            padding: 0.8rem;
            font-size: 1rem;
            border: 2px solid var(--gold-accent);
            background: var(--metallic-black);
            color: var(--steel-white);
            border-radius: 8px;
            outline: none;
        }
        .contact button {
            background: var(--gold-accent);
            color: var(--metallic-black);
            padding: 0.8rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
        }
        .contact button:hover {
            background: #8c6b25;
        }
        #contact-feedback {
            margin-top: 1rem;
            font-size: 1rem;
        }
        footer {
            background: var(--metallic-black);
            padding: 2rem;
            text-align: center;
            border-top: 2px solid var(--gold-accent);
        }
        footer img.logo {
            height: 40px;
            margin: 1rem 0;
        }
        #back-to-top {
            position: fixed;
            bottom: 1.5rem;
            right: 1.5rem;
            background: var(--gold-accent);
            color: var(--metallic-black);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            display: none;
            z-index: 1000;
            font-size: 1rem;
            line-height: 40px;
            text-align: center;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        #back-to-top:hover {
            opacity: 1;
        }
        @media (max-width: 768px) {
            .header-container {
                flex-direction: column;
                align-items: flex-start;
            }
            nav {
                width: 100%;
            }
            nav ul {
                display: none;
                flex-direction: column;
                position: absolute;
                top: 80px;
                left: 0;
                width: 100%;
                background: var(--metallic-black);
                padding: 1rem;
            }
            nav ul.active {
                display: flex;
            }
            #hamburger {
                display: block;
                position: absolute;
                top: 1rem;
                right: 1rem;
            }
            .cart-icon {
                position: absolute;
                top: 1rem;
                left: 1rem;
            }
            .logo {
                margin: 0 auto;
            }
            .hero h1 {
                font-size: 3rem;
            }
            .search-bar {
                width: 90%;
            }
            .cart-item {
                grid-template-columns: 80px 1fr;
                gap: 1rem;
                text-align: left;
            }
            .cart-item img {
                grid-row: 1 / 3;
            }
            .cart-item .quantity-controls {
                grid-column: 2;
            }
        }
    </style>
</head>
<body>
    <div class="snow-container"></div>
    <header>
        <div class="header-container">
            <div class="cart-icon" aria-label="View cart">
                <span id="cart-count">0</span>
                <img src="images/cart-icon.png" alt="Cart">
            </div>
            <div class="logo">
                <img src="images/logo.png" alt="AzulaBlitz Logo">
            </div>
            <nav>
                <span id="hamburger" aria-label="Toggle menu">☰</span>
                <ul>
                    <li><a href="#about">About Us</a></li>
                    <li><a href="#contact">Contact</a></li>
                </ul>
            </nav>
        </div>
    </header>
    <main>
        <section class="hero">
            <h1>Welcome to AzulaBlitz</h1>
            <p class="tagline">Curated Elegance in Every Scent</p>
            <div class="search-bar">
                <input type="text" id="search-input" placeholder="Search fragrances (e.g., 'YSL EDP under $40')..." aria-label="Search fragrances">
                <button id="clear-search" aria-label="Clear search">X</button>
                <div id="autocomplete"></div>
            </div>
            <p id="no-results">No results found.</p>
        </section>
        <section id="products" class="featured">
            <h2>Fragrances</h2>
            <div class="brand-section">
                <h3>YSL</h3>
                <div class="grid">
                    <div class="grid-item" data-product="ysl-mon-paris-edp-90ml">
                        <img src="images/ysl-mon-paris-90ml.jpg" alt="Mon Paris EDP 90mL">
                        <h4>Mon Paris (EDP) 90mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="ysl-mon-paris-edp-90ml" data-price="35">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="ysl-black-opium-edp-90ml">
                        <img src="images/ysl-black-opium-90ml.jpg" alt="Black Opium EDP 90mL">
                        <h4>Black Opium (EDP) 90mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="ysl-black-opium-edp-90ml" data-price="35">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="ysl-mon-paris-edp-50ml">
                        <img src="images/ysl-mon-paris-50ml.jpg" alt="Mon Paris EDP 50mL">
                        <h4>Mon Paris (EDP) 50mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="ysl-mon-paris-edp-50ml" data-price="35">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="ysl-black-opium-edp-50ml">
                        <img src="images/ysl-black-opium-50ml.jpg" alt="Black Opium EDP 50mL">
                        <h4>Black Opium (EDP) 50mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="ysl-black-opium-edp-50ml" data-price="35">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="ysl-libre-edp-90ml">
                        <img src="images/ysl-libre-90ml.jpg" alt="Libre EDP 90mL">
                        <h4>Libre (EDP) 90mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="ysl-libre-edp-90ml" data-price="35">Add to Cart</button>
                    </div>
                    <!-- Additional YSL products omitted for brevity -->
                </div>
                <hr>
            </div>
            <div class="brand-section">
                <h3>Dior</h3>
                <div class="grid">
                    <div class="grid-item" data-product="dior-sauvage-edt-100ml">
                        <img src="images/dior-sauvage-edt-100ml.jpg" alt="Sauvage EDT 100mL">
                        <h4>Sauvage (EDT) 100mL</h4>
                        <p class="price">$38.50</p>
                        <button class="add-to-cart-btn" data-product-id="dior-sauvage-edt-100ml" data-price="38.5">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="dior-hypnotic-poison-edp-100ml">
                        <img src="images/dior-hypnotic-poison-100ml.jpg" alt="Hypnotic Poison EDP 100mL">
                        <h4>Hypnotic Poison (EDP) 100mL</h4>
                        <p class="price">$38.50</p>
                        <button class="add-to-cart-btn" data-product-id="dior-hypnotic-poison-edp-100ml" data-price="38.5">Add to Cart</button>
                    </div>
                </div>
                <hr>
            </div>
            <div class="brand-section">
                <h3>Versace</h3>
                <div class="grid">
                    <div class="grid-item" data-product="versace-bright-crystal-edt-90ml">
                        <img src="images/versace-bright-crystal-90ml.jpg" alt="Bright Crystal EDT 90mL">
                        <h4>Bright Crystal (EDT) 90mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="versace-bright-crystal-edt-90ml" data-price="35">Add to Cart</button>
                    </div>
                    <div class="grid-item" data-product="versace-eros-edt-100ml">
                        <img src="images/versace-eros-100ml.jpg" alt="Eros EDT 100mL">
                        <h4>Eros (EDT) 100mL</h4>
                        <p class="price">$35.00</p>
                        <button class="add-to-cart-btn" data-product-id="versace-eros-edt-100ml" data-price="35">Add to Cart</button>
                    </div>
                    <!-- Additional Versace products omitted for brevity -->
                </div>
                <hr>
            </div>
            <!-- Additional brand sections (e.g., Xerjoff, Valentino, TF, etc.) omitted for brevity -->
        </section>
        <section id="about" class="about">
            <h2>About AzulaBlitz</h2>
            <p>AzulaBlitz is your premier destination for luxury fragrances. We curate an extensive collection of high-end perfumes from renowned brands, offering you the finest scents to elevate your presence. Our mission is to provide exceptional quality and customer service, ensuring every purchase is a delightful experience.</p>
        </section>
        <section id="contact" class="contact">
            <h2>Contact Us</h2>
            <p>Reach out for inquiries via the form below or email us at <a href="mailto:blitzazula@gmail.com">blitzazula@gmail.com</a>.</p>
            <form id="contact-form">
                <input type="text" id="name" placeholder="Your Name" required aria-label="Your Name">
                <input type="email" id="email" placeholder="Your Email" required aria-label="Your Email">
                <textarea id="message" placeholder="Your Message" required aria-label="Your Message"></textarea>
                <button type="submit">Send Message</button>
            </form>
            <p id="contact-feedback"></p>
        </section>
    </main>
    <footer>
        <img src="images/logo.png" alt="AzulaBlitz Logo" class="logo">
        <p>© 2025 AzulaBlitz. All rights reserved.</p>
    </footer>
    <button id="back-to-top" aria-label="Back to top">↑</button>
    <div id="cart-view">
        <div class="cart-content">
            <button id="close-cart" aria-label="Close cart">X</button>
            <h2>Your Cart</h2>
            <div id="cart-items"></div>
            <div class="cart-summary">
                <p id="cart-subtotal">Subtotal: $0.00</p>
                <p id="cart-tax">Tax: $0.00</p>
                <p id="cart-shipping">Shipping: $0.00</p>
                <p id="cart-total">Total: $0.00</p>
            </div>
            <div id="shipping-form">
                <h3>Shipping Details</h3>
                <input type="text" id="shipping-name" placeholder="Full Name" required aria-label="Full Name">
                <span class="error">Please enter your full name.</span>
                <input type="email" id="shipping-email" placeholder="Email" required aria-label="Email">
                <span class="error">Please enter a valid email.</span>
                <input type="text" id="shipping-address" placeholder="Address" required aria-label="Address">
                <span class="error">Please enter your address.</span>
                <input type="text" id="shipping-city" placeholder="City" required aria-label="City">
                <span class="error">Please enter your city.</span>
                <input type="text" id="shipping-state" placeholder="State" required aria-label="State">
                <span class="error">Please enter your state.</span>
                <input type="text" id="shipping-zip" placeholder="ZIP Code" required pattern="\d{5}" aria-label="ZIP Code">
                <span class="error">Please enter a valid ZIP code.</span>
                <label><input type="checkbox" id="is-international" aria-label="International Shipping"> International Shipping</label>
                <select id="shipping-service" aria-label="Shipping service">
                    <option value="ground">Ground (3-7 days)</option>
                    <option value="2day">2-Day (2 days)</option>
                    <option value="overnight">Overnight (1 day)</option>
                </select>
            </div>
            <div id="payment-form">
                <h3>Payment Details</h3>
                <div id="card-element"></div>
                <span id="card-error" class="error"></span>
            </div>
            <button id="checkout-btn">Proceed to Checkout</button>
        </div>
    </div>
    <div id="checkout-modal">
        <div class="modal-content">
            <button id="close-modal" aria-label="Close modal">X</button>
            <h2>Order Confirmation</h2>
            <div id="order-preview"></div>
            <p id="estimated-delivery"></p>
            <button id="confirm-order">Confirm Order</button>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.6.2"></script>
    <script>
        const stripe = Stripe('pk_test_your_publishable_key');
        const elements = stripe.elements();
        let cardElement;

        const productDetails = {
            "ysl-mon-paris-edp-90ml": {
                name: "YSL Mon Paris EDP 90mL",
                image: "images/ysl-mon-paris-90ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "EA"
            },
            "ysl-mon-paris-edp-50ml": {
                name: "YSL Mon Paris EDP 50mL",
                image: "images/ysl-mon-paris-50ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "EC"
            },
            "ysl-black-opium-edp-90ml": {
                name: "YSL Black Opium EDP 90mL",
                image: "images/ysl-black-opium-90ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "EE"
            },
            "ysl-black-opium-edp-50ml": {
                name: "YSL Black Opium EDP 50mL",
                image: "images/ysl-black-opium-50ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "EF"
            },
            "ysl-libre-edp-90ml": {
                name: "YSL Libre EDP 90mL",
                image: "images/ysl-libre-90ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "AEH"
            },
            "ysl-libre-edp-50ml": {
                name: "YSL Libre EDP 50mL",
                image: "images/ysl-libre-50ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "AEI"
            },
            "ysl-saharienne-75ml": {
                name: "YSL Saharienne 75mL",
                image: "images/ysl-saharienne-75ml.jpg",
                price: 38.5,
                brand: "YSL",
                type: "Unknown",
                productNo: "BFE"
            },
            "ysl-grain-de-poudre-75ml": {
                name: "YSL Grain de Poudre 75mL",
                image: "images/ysl-grain-de-poudre-75ml.jpg",
                price: 38.5,
                brand: "YSL",
                type: "Unknown",
                productNo: "BFF"
            },
            "ysl-tuxedo-75ml": {
                name: "YSL Tuxedo 75mL",
                image: "images/ysl-tuxedo-75ml.jpg",
                price: 38.5,
                brand: "YSL",
                type: "Unknown",
                productNo: "BFG"
            },
            "ysl-blouse-75ml": {
                name: "YSL Blouse 75mL",
                image: "images/ysl-blouse-75ml.jpg",
                price: 38.5,
                brand: "YSL",
                type: "Unknown",
                productNo: "BFH"
            },
            "ysl-labsolu-platine-edp-90ml": {
                name: "YSL Labsolu Platine EDP 90mL",
                image: "images/ysl-labsolu-platine-90ml.jpg",
                price: 45.5,
                brand: "YSL",
                type: "EDP",
                productNo: "CAF"
            },
            "ysl-myslf-edp-90ml": {
                name: "YSL MYSLF EDP 90mL",
                image: "images/ysl-myslf-90ml.jpg",
                price: 45.5,
                brand: "YSL",
                type: "EDP",
                productNo: "CAG"
            },
            "ysl-y-edp-intense-100ml": {
                name: "YSL Y EDP Intense 100mL",
                image: "images/ysl-y-edp-intense-100ml.jpg",
                price: 43.75,
                brand: "YSL",
                type: "EDP",
                productNo: "CDJ"
            },
            "ysl-y-edp-100ml": {
                name: "YSL Y EDP 100mL",
                image: "images/ysl-y-edp-100ml.jpg",
                price: 43.75,
                brand: "YSL",
                type: "EDP",
                productNo: "CDA"
            },
            "ysl-y-edt-100ml": {
                name: "YSL Y EDT 100mL",
                image: "images/ysl-y-edt-100ml.jpg",
                price: 43.75,
                brand: "YSL",
                type: "EDT",
                productNo: "CDB"
            },
            "ysl-black-opium-eau-de-parfum-glitter-edp-90ml": {
                name: "YSL Black Opium Eau de Parfum Glitter EDP 90mL",
                image: "images/ysl-black-opium-glitter-90ml.jpg",
                price: 35,
                brand: "YSL",
                type: "EDP",
                productNo: "DJJ"
            },
            "versace-bright-crystal-edt-90ml": {
                name: "Versace Bright Crystal EDT 90mL",
                image: "images/versace-bright-crystal-90ml.jpg",
                price: 35,
                brand: "Versace",
                type: "EDT",
                productNo: "EG"
            },
            "versace-eros-edt-100ml": {
                name: "Versace Eros EDT 100mL",
                image: "images/versace-eros-100ml.jpg",
                price: 35,
                brand: "Versace",
                type: "EDT",
                productNo: "ADH"
            },
            "versace-eros-flame-edt-100ml": {
                name: "Versace Eros Flame EDT 100mL",
                image: "images/versace-eros-flame-100ml.jpg",
                price: 35,
                brand: "Versace",
                type: "EDT",
                productNo: "ADI"
            },
            "versace-eau-fraiche-edt-100ml": {
                name: "Versace Eau Fraiche EDT 100mL",
                image: "images/versace-eau-fraiche-100ml.jpg",
                price: 35,
                brand: "Versace",
                type: "EDT",
                productNo: "AFI"
            },
            // Additional products omitted for brevity; full list includes all valid PDF entries
        };

        let cart = JSON.parse(localStorage.getItem('cart')) || {};

        const packageEstimates = {
            30: { length: 2.5, width: 1.5, height: 1, weight: 0.5 },
            50: { length: 3, width: 1.5, height: 1, weight: 0.8 },
            60: { length: 3.2, width: 1.6, height: 1, weight: 0.9 },
            70: { length: 3.5, width: 1.7, height: 1, weight: 1.0 },
            75: { length: 3.5, width: 1.7, height: 1, weight: 1.1 },
            80: { length: 3.6, width: 1.8, height: 1, weight: 1.2 },
            90: { length: 3.8, width: 1.9, height: 1, weight: 1.3 },
            100: { length: 4, width: 2, height: 1, weight: 1.5 },
            125: { length: 4.5, width: 2.2, height: 1.2, weight: 1.8 }
        };

        const taxRates = {
            '10001': 0.08875,
            '90210': 0.095,
            'default': 0.08
        };

        const shippingRates = {
            usps: {
                ground: { base: 5.5, perLb: 0.6, perZone: 0.5, days: 5 },
                '2day': { base: 12, perLb: 0.9, perZone: 1, days: 2 },
                overnight: { base: 25, perLb: 1.5, perZone: 2, days: 1 }
            },
            fedex: {
                ground: { base: 7, perLb: 0.7, perZone: 0.6, days: 4 },
                '2day': { base: 15, perLb: 1, perZone: 1.2, days: 2 },
                overnight: { base: 30, perLb: 1.8, perZone: 2.5, days: 1 }
            },
            ups: {
                ground: { base: 6, perLb: 0.65, perZone: 0.55, days: 5 },
                '2day': { base: 13, perLb: 0.95, perZone: 1.1, days: 2 },
                overnight: { base: 28, perLb: 1.6, perZone: 2.2, days: 1 }
            }
        };

        function generateOrderId() {
            return 'AZB-' + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        function updateCartCount() {
            const count = Object.values(cart).reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cart-count').textContent = count;
        }

        function calculateTax(subtotal, zip) {
            const rate = taxRates[zip] || taxRates['default'];
            return parseFloat((subtotal * rate).toFixed(2));
        }

        function getZone(zip) {
            const zipNum = parseInt(zip.substring(0, 3));
            if (zipNum < 300) return 1;
            if (zipNum < 600) return 2;
            return 3;
        }

        function calculateShipping(cart, isInternational, service, zip) {
            if (Object.keys(cart).length === 0) return { cost: 0, carrier: '', service: '', deliveryDate: '', days: 0 };

            let totalLength = 0, totalWidth = 0, totalHeight = 0, totalWeight = 0;
            let totalItems = 0;

            for (const [id, item] of Object.entries(cart)) {
                const product = productDetails[id];
                const volume = parseInt(product.name.match(/\d+mL/i)?.[0]) || 100;
                const estimate = packageEstimates[volume] || packageEstimates[100];
                totalLength += estimate.length * item.quantity;
                totalWidth += estimate.width * item.quantity;
                totalHeight += estimate.height * item.quantity;
                totalWeight += estimate.weight * item.quantity;
                totalItems += item.quantity;
            }

            totalLength = Math.max(totalLength / Math.sqrt(totalItems), 4);
            totalWidth = Math.max(totalWidth / Math.sqrt(totalItems), 3);
            totalHeight = Math.max(totalHeight, 2);
            totalWeight = Math.max(totalWeight, 1);

            const volume = totalLength * totalWidth * totalHeight;
            const dimensionalWeight = volume / 166;
            const billableWeight = Math.max(totalWeight, dimensionalWeight);
            const zone = getZone(zip);
            const subtotal = Object.entries(cart).reduce((sum, [id, item]) => sum + item.quantity * productDetails[id].price, 0);

            const costs = Object.entries(shippingRates).flatMap(([carrier, services]) =>
                Object.entries(services).map(([svc, details]) => {
                    if (svc !== service) return null;
                    let cost = details.base + (billableWeight * details.perLb) + (zone * details.perZone);
                    if (subtotal > 150) cost *= 0.9;
                    if (isInternational) cost *= 2.5;
                    if (totalItems > 5) cost *= 1.1;
                    cost = Math.max(cost, 5);
                    const deliveryDays = isInternational ? details.days + 3 : details.days;
                    const deliveryDate = new Date();
                    deliveryDate.setDate(deliveryDate.getDate() + deliveryDays);
                    return {
                        carrier,
                        cost: parseFloat(cost.toFixed(2)),
                        service: svc,
                        deliveryDate: deliveryDate.toLocaleDateString(),
                        days: deliveryDays
                    };
                }).filter(Boolean)
            );

            return costs.reduce((min, curr) => curr.cost < min.cost ? curr : min, costs[0]);
        }

        function updateCartView() {
            const cartItems = document.getElementById('cart-items');
            cartItems.innerHTML = '';
            let subtotal = 0;

            for (const [id, item] of Object.entries(cart)) {
                const product = productDetails[id] || { name: 'Unknown Product', price: 0, image: '' };
                const itemTotal = item.quantity * product.price;
                subtotal += itemTotal;

                const div = document.createElement('div');
                div.className = 'cart-item';
                div.innerHTML = `
                    <img src="${product.image}" alt="${product.name}">
                    <span>${product.name} ($${product.price.toFixed(2)})</span>
                    <div class="quantity-controls">
                        <button data-id="${id}" class="decrement">-</button>
                        <input type="number" value="${item.quantity}" min="1" data-id="${id}" aria-label="Quantity for ${product.name}">
                        <button data-id="${id}" class="increment">+</button>
                    </div>
                    <button data-id="${id}" class="remove">Remove</button>
                `;
                cartItems.appendChild(div);
            }

            const zip = document.getElementById('shipping-zip').value || '10001';
            const tax = calculateTax(subtotal, zip);
            const isInternational = document.getElementById('is-international').checked;
            const service = document.getElementById('shipping-service').value;
            const shipping = calculateShipping(cart, isInternational, service, zip);
            const total = subtotal + tax + shipping.cost;

            document.getElementById('cart-subtotal').textContent = `Subtotal: $${subtotal.toFixed(2)}`;
            document.getElementById('cart-tax').textContent = `Tax: $${tax.toFixed(2)}`;
            document.getElementById('cart-shipping').textContent = `Shipping: $${shipping.cost.toFixed(2)} (via ${shipping.carrier.toUpperCase()} ${shipping.service})`;
            document.getElementById('cart-total').textContent = `Total: $${total.toFixed(2)}`;
        }

        function initializeStripe() {
            cardElement = elements.create('card', {
                style: {
                    base: {
                        color: '#C0C0C0',
                        fontFamily: '"Roboto", sans-serif',
                        fontSize: '16px',
                        '::placeholder': { color: '#8c6b25' }
                    }
                }
            });
            cardElement.mount('#card-element');
        }

        function parseSearchQuery(query) {
            const tokens = query.toLowerCase().split(/\s+/);
            let brand = '', type = '', priceMax = Infinity, keywords = [];
            const types = ['edp', 'edt', 'parfum'];

            tokens.forEach(token => {
                if (token.includes('under') || token.includes('below')) {
                    const price = parseFloat(token.replace(/[^0-9.]/g, ''));
                    if (!isNaN(price)) priceMax = price;
                } else if (types.includes(token)) {
                    type = token.toUpperCase();
                } else if (Object.values(productDetails).some(p => p.brand.toLowerCase().includes(token))) {
                    brand = token;
                } else {
                    keywords.push(token);
                }
            });

            return { brand, type, priceMax, keywords: keywords.join(' ') };
        }

        document.addEventListener('DOMContentLoaded', () => {
            initializeStripe();
            updateCartCount();

            document.querySelectorAll('.add-to-cart-btn').forEach(button => {
                button.addEventListener('click', () => {
                    const id = button.dataset.productId;
                    cart[id] = cart[id] || { quantity: 0 };
                    cart[id].quantity += 1;
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartCount();
                });
            });

            document.getElementById('cart-items').addEventListener('click', e => {
                const id = e.target.dataset.id;
                if (e.target.classList.contains('increment')) {
                    cart[id].quantity += 1;
                } else if (e.target.classList.contains('decrement')) {
                    cart[id].quantity = Math.max(1, cart[id].quantity - 1);
                } else if (e.target.classList.contains('remove')) {
                    delete cart[id];
                }
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartView();
                updateCartCount();
            });

            document.getElementById('cart-items').addEventListener('change', e => {
                if (e.target.type === 'number') {
                    const id = e.target.dataset.id;
                    const quantity = parseInt(e.target.value);
                    if (quantity > 0) {
                        cart[id].quantity = quantity;
                    } else {
                        delete cart[id];
                    }
                    localStorage.setItem('cart', JSON.stringify(cart));
                    updateCartView();
                    updateCartCount();
                }
            });

            document.querySelector('.cart-icon').addEventListener('click', () => {
                document.getElementById('cart-view').classList.add('visible');
                updateCartView();
            });

            document.getElementById('close-cart').addEventListener('click', () => {
                document.getElementById('cart-view').classList.remove('visible');
            });

            document.getElementById('checkout-btn').addEventListener('click', async () => {
                const name = document.getElementById('shipping-name').value;
                const email = document.getElementById('shipping-email').value;
                const address = document.getElementById('shipping-address').value;
                const city = document.getElementById('shipping-city').value;
                const state = document.getElementById('shipping-state').value;
                const zip = document.getElementById('shipping-zip').value;
                const isInternational = document.getElementById('is-international').checked;
                const service = document.getElementById('shipping-service').value;

                if (!name || !email || !address || !city || !state || !zip) {
                    alert('Please fill out all shipping details.');
                    return;
                }

                const subtotal = Object.entries(cart).reduce((sum, [id, item]) => sum + item.quantity * productDetails[id].price, 0);
                const tax = calculateTax(subtotal, zip);
                const shipping = calculateShipping(cart, isInternational, service, zip);
                const total = subtotal + tax + shipping.cost;

                const orderPreview = document.getElementById('order-preview');
                orderPreview.innerHTML = `
                    <h3>Order Summary</h3>
                    <ul>
                        ${Object.entries(cart).map(([id, item]) => `
                            <li>${productDetails[id].name} (${productDetails[id].productNo}) x${item.quantity} - $${(item.quantity * productDetails[id].price).toFixed(2)}</li>
                        `).join('')}
                    </ul>
                    <p>Subtotal: $${subtotal.toFixed(2)}</p>
                    <p>Tax: $${tax.toFixed(2)}</p>
                    <p>Shipping: $${shipping.cost.toFixed(2)} (via ${shipping.carrier.toUpperCase()} ${shipping.service})</p>
                    <p>Total: $${total.toFixed(2)}</p>
                    <h3>Shipping Details</h3>
                    <p>${name}</p>
                    <p>${email}</p>
                    <p>${address}, ${city}, ${state} ${zip}</p>
                `;
                document.getElementById('estimated-delivery').textContent = `Estimated Delivery: ${shipping.deliveryDate}`;
                document.getElementById('checkout-modal').style.display = 'flex';
                document.getElementById('checkout-modal').classList.add('visible');
                document.getElementById('cart-view').classList.remove('visible');
            });

            document.getElementById('close-modal').addEventListener('click', () => {
                document.getElementById('checkout-modal').classList.remove('visible');
                document.getElementById('checkout-modal').style.display = 'none';
            });

            document.getElementById('confirm-order').addEventListener('click', async () => {
                const name = document.getElementById('shipping-name').value;
                const email = document.getElementById('shipping-email').value;
                const address = document.getElementById('shipping-address').value;
                const city = document.getElementById('shipping-city').value;
                const state = document.getElementById('shipping-state').value;
                const zip = document.getElementById('shipping-zip').value;
                const isInternational = document.getElementById('is-international').checked;
                const service = document.getElementById('shipping-service').value;

                const subtotal = Object.entries(cart).reduce((sum, [id, item]) => sum + item.quantity * productDetails[id].price, 0);
                const tax = calculateTax(subtotal, zip);
                const shipping = calculateShipping(cart, isInternational, service, zip);
                const total = subtotal + tax + shipping.cost;

                const { error, paymentMethod } = await stripe.createPaymentMethod({
                    type: 'card',
                    card: cardElement,
                    billing_details: {
                        name,
                        email,
                        address: { line1: address, city, state, postal_code: zip }
                    }
                });

                if (error) {
                    document.getElementById('card-error').textContent = error.message;
                    return;
                }

                const response = await fetch('/create-payment-intent', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        amount: Math.round(total * 100),
                        currency: 'usd',
                        payment_method: paymentMethod.id
                    })
                });

                const { clientSecret } = await response.json();

                const { error: confirmError } = await stripe.confirmCardPayment(clientSecret, {
                    payment_method: paymentMethod.id
                });

                if (confirmError) {
                    document.getElementById('card-error').textContent = confirmError.message;
                    return;
                }

                const orderId = generateOrderId();
                const timestamp = new Date().toISOString();
                const orderDetails = {
                    orderId,
                    timestamp,
                    items: Object.entries(cart).map(([id, item]) => ({
                        name: productDetails[id].name,
                        productNo: productDetails[id].productNo,
                        quantity: item.quantity,
                        price: productDetails[id].price
                    })),
                    shipping: {
                        name,
                        email,
                        address: `${address}, ${city}, ${state} ${zip}`,
                        carrier: shipping.carrier,
                        service: shipping.service,
                        isInternational,
                        cost: shipping.cost,
                        estimatedDelivery: shipping.deliveryDate
                    },
                    subtotal,
                    tax,
                    total
                };

                await fetch('https://discord.com/api/webhooks/1366382699429761044/4z_xzv4kFKB2Y4wO8bQanELHXqG2IArYVqE83YvbN6XhQ5fCcmzDaWfnW5bM2xZOpb7N', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        content: `New Order:\n${JSON.stringify(orderDetails, null, 2)}`
                    })
                });

                try {
                    await fetch('/send-order-email', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(orderDetails)
                    });
                } catch (error) {
                    console.error('Email sending failed:', error);
                }

                alert('Order confirmed! You will receive a confirmation email soon.');
                cart = {};
                localStorage.setItem('cart', JSON.stringify(cart));
                updateCartCount();
                document.getElementById('checkout-modal').classList.remove('visible');
                document.getElementById('checkout-modal').style.display = 'none';
            });

            const fuse = new Fuse(Object.entries(productDetails).map(([id, product]) => ({ id, ...product })), {
                keys: [
                    { name: 'name', weight: 0.4 },
                    { name: 'brand', weight: 0.3 },
                    { name: 'type', weight: 0.2 },
                    { name: 'productNo', weight: 0.1 }
                ],
                threshold: 0.3,
                includeMatches: true
            });

            function updateSearchResults() {
                const query = document.getElementById('search-input').value;
                const { brand, type, priceMax, keywords } = parseSearchQuery(query);
                const autocomplete = document.getElementById('autocomplete');
                autocomplete.innerHTML = '';
                let results = keywords ? fuse.search(keywords).map(r => r.item) : Object.entries(productDetails).map(([id, p]) => ({ id, ...p }));

                if (brand) results = results.filter(p => p.brand.toLowerCase().includes(brand));
                if (type) results = results.filter(p => p.type === type);
                if (priceMax !== Infinity) results = results.filter(p => p.price <= priceMax);

                const items = document.querySelectorAll('.grid-item');
                const brands = document.querySelectorAll('.brand-section');
                items.forEach(item => item.classList.add('hidden'));
                brands.forEach(brand => brand.classList.add('hidden'));

                results.forEach(product => {
                    const item = document.querySelector(`.grid-item[data-product="${product.id}"]`);
                    if (item) {
                        item.classList.remove('hidden');
                        const brandSection = item.closest('.brand-section');
                        if (brandSection) brandSection.classList.remove('hidden');
                    }
                });

                if (query && results.length > 0) {
                    results.slice(0, 5).forEach(product => {
                        const div = document.createElement('div');
                        div.className = 'autocomplete-item';
                        div.innerHTML = `
                            <span>${product.name} (${product.brand})</span>
                            <span class="product-type">${product.type}</span>
                        `;
                        div.addEventListener('click', () => {
                            document.getElementById('search-input').value = product.name;
                            items.forEach(item => item.classList.add('hidden'));
                            brands.forEach(brand => brand.classList.add('hidden'));
                            const selectedItem = document.querySelector(`.grid-item[data-product="${product.id}"]`);
                            if (selectedItem) {
                                selectedItem.classList.remove('hidden');
                                const brandSection = selectedItem.closest('.brand-section');
                                if (brandSection) brandSection.classList.remove('hidden');
                            }
                            autocomplete.style.display = 'none';
                        });
                        autocomplete.appendChild(div);
                    });
                    autocomplete.style.display = 'block';
                } else {
                    autocomplete.style.display = 'none';
                }

                document.getElementById('no-results').style.display = query && results.length === 0 ? 'block' : 'none';
                document.getElementById('clear-search').style.display = query ? 'block' : 'none';
            }

            document.getElementById('search-input').addEventListener('input', updateSearchResults);
            document.getElementById('clear-search').addEventListener('click', () => {
                document.getElementById('search-input').value = '';
                document.querySelectorAll('.grid-item').forEach(item => item.classList.remove('hidden'));
                document.querySelectorAll('.brand-section').forEach(brand => brand.classList.remove('hidden'));
                document.getElementById('autocomplete').style.display = 'none';
                document.getElementById('no-results').style.display = 'none';
                document.getElementById('clear-search').style.display = 'none';
            });

            document.getElementById('shipping-service').addEventListener('change', updateCartView);
            document.getElementById('is-international').addEventListener('change', updateCartView);
            document.getElementById('shipping-zip').addEventListener('input', updateCartView);

            document.getElementById('hamburger').addEventListener('click', () => {
                document.querySelector('nav ul').classList.toggle('active');
            });

            document.getElementById('back-to-top').addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });

            window.addEventListener('scroll', () => {
                document.getElementById('back-to-top').style.display = window.scrollY > 300 ? 'block' : 'none';
            });

            document.getElementById('contact-form').addEventListener('submit', async e => {
                e.preventDefault();
                const feedback = document.getElementById('contact-feedback');
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                const message = document.getElementById('message').value;

                if (!name || !email || !message) {
                    feedback.textContent = 'Please fill out all fields.';
                    feedback.style.color = '#ff5555';
                    return;
                }

                try {
                    const response = await fetch('https://discord.com/api/webhooks/1366382699429761044/4z_xzv4kFKB2Y4wO8bQanELHXqG2IArYVqE83YvbN6XhQ5fCcmzDaWfnW5bM2xZOpb7N', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            content: `Contact Form Submission:\nName: ${name}\nEmail: ${email}\nMessage: ${message}`
                        })
                    });

                    if (response.ok) {
                        feedback.textContent = 'Message sent! We will get back to you soon.';
                        feedback.style.color = '#A37E2C';
                        document.getElementById('contact-form').reset();
                    } else {
                        feedback.textContent = 'Error sending message. Please try again.';
                        feedback.style.color = '#ff5555';
                    }
                } catch (error) {
                    feedback.textContent = 'Error sending message. Please try again.';
                    feedback.style.color = '#ff5555';
                    console.error(error);
                }
            });

            const snowContainer = document.querySelector('.snow-container');
            for (let i = 0; i < 50; i++) {
                const snowflake = document.createElement('div');
                snowflake.className = 'snowflake';
                snowflake.style.left = `${Math.random() * 100}vw`;
                snowflake.style.animationDuration = `${Math.random() * 5 + 5}s`;
                snowflake.style.animationDelay = `${Math.random() * 5}s`;
                snowContainer.appendChild(snowflake);
            }
        });
    </script>
</body>
</html>
